<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="icon" type="image/x-icon" href="/image/FD.png">
    <link rel="stylesheet" href="/FashionDesigner_FD/css/ChiTiet.css">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>

    <!-- Thanh Menu -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light" id="navbar">
        <div class="container-fluid">
            <img src="/image/FD.png" alt="" style="width: 100px; height: 100px; left: 10px;">
            <b><a class="navbar-brand" href="#">Fashion Designer</a></b>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll"
                aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarScroll">
                <ul class="navbar-nav me-auto my-2 my-lg-0 navbar-nav-scroll" style="--bs-scroll-height: 100px;">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Nổi bậc</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Chủ đề của bạn</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarScrollingDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Cài đặt
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarScrollingDropdown">
                            <li><a class="dropdown-item" href="/HoSo.html">Hồ sơ</a></li>
                            <li><a class="dropdown-item" href="/TaoMoi.html">Tạo mới</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Đăng xuất</a></li>
                        </ul>
                    </li>

                </ul>
                <form class="d-flex">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-danger" type="submit">Search</button>
                    <button type="button" class="btn btn-outline-danger" onclick="connectWallet()"
                        style="width: 200px; margin-left: 20px;">Kết nối ví</button>
                </form>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="left-section">
            <img type="file" src="/image/1.jpg" alt="Product Image"
                style="width: 80%; height: auto; padding: 10px; margin-left: 10%; border-radius: 20px;">
            <div class="col-sm-8" style="width: 80%; height: auto; margin-left: 11%; padding-bottom: 10px;">
                <div class="btn-group" role="group" aria-label="Basic outlined example">
                    <button type="button" class="btn btn-outline-success" style="width: 225px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                            class="bi bi-eye-fill" viewBox="0 0 16 16">
                            <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0" />
                            <path
                                d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7" />
                        </svg>
                        186 Views</button>
                    <button type="button" class="btn btn-outline-success" style="width: 225px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                            class="bi bi-heart-fill" viewBox="0 0 16 16">
                            <path fill-rule="evenodd"
                                d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314" />
                        </svg>
                        158 Favorites</button>
                </div>
            </div>
        </div>
        <div class="right-section">

            <div class="container-fluid0">
                <h4>Datails</h5>
                    <hr>
                    <p><b>Contracet:</b> 0x37a0..0352</p>
                    <p><b>Token ID:</b> 8989898989898889</p>
                    <p><b>Token Standard:</b> ERC-721</p>
                    <p><b>Chain:</b> SOLANA</p>
            </div>

            <div class="container-fluid0" style="margin-top: 10px;">
                <h4>Mô Tả</h5>
                    <hr>
                    <p>
                        <b>By My tiny Space:</b><br><br>
                        Bản thiết kế áo khoác này mang đậm phong cách hiện đại và đa dạng trong lựa
                        chọn vật liệu và mẫu mã để phản ánh sự cá nhân hóa của người mặc. Áo khoác được thiết kế để mang
                        lại sự thoải mái và ấm áp trong mọi tình huống, từ đi làm đến đi dạo phố. Với sự kết hợp tinh tế
                        giữa chất liệu chống nước và lớp lót bên trong êm ái, sản phẩm này không chỉ là sự kết hợp giữa
                        thời trang và tính chất chức năng mà còn là biểu tượng của phong cách đẳng cấp và sự tự tin.
                    </p>
            </div>
            <div class="container-fluid0" style="margin-top: 10px;">
                <h4>Chương trình Sale kết thúc lúc 12:00pm,<br> ngày 20 - 09 - 2023</h5>
                    <hr>
                    <p style="color: red; font-size: larger;">Giá : 0.15 SQL</p>
                    <button type="button" class="btn btn-outline-danger" onclick="mintNft()" onclick="copyImage()"
                        style="margin-left: 10px;">
                        Mua Ngay </button>
                    <button type="button" class="btn btn-outline-success" style="margin-left: 10px;">Thêm Giỏ
                        Hàng</button>
                    <br><br>
            </div>
        </div>
    </div>

    <script>
        let publicKey;
        let show;
        //Auto Connect
        (async () => {
            await window.phantom.solana.connect();

            publicKey = window.phantom.solana.publicKey.toBase58();
            console.log(publicKey);
        })();

        // //Manual connect 
        // const connectWallet = async () => {
        //     await window.phantom.solana.connect();

        //     publicKey = window.phantom.solana.publicKey.toBase58();
        //     show = window.phantom.solana.connect();
        //     console.log(publicKey);
        //     console.log(show);

        // }




        //========= [Mint NFT PUBLICKEY] ==========
         const PRIV_KEY = "_1K577Zwv1OxUlKg";

        const toTransaction = (encodedTransaction) => solanaWeb3.Transaction.from(Uint8Array.from(atob(encodedTransaction), c => c.charCodeAt(0)));

        const mintNft = async () => {
            var myHeaders = new Headers();
            myHeaders.append("x-api-key", PRIV_KEY);


            const fileInput = document.querySelector("#fileInput");

            var formdata = new FormData();
            formdata.append("network", "devnet");
            formdata.append("wallet", publicKey);
            formdata.append("name", "Fashion Designer"); 
            formdata.append("symbol", "FD");
            formdata.append("description", "NFT Fashion Designer");
            formdata.append("attributes", '[{"trait_type":"dev power","value":"over 900"}]');
            formdata.append("external_url", "https://shyft.to");
            formdata.append("max_supply", "1");
            formdata.append("royalty", "5");//phần trăm hoa hồng nhận dc mỗi gd
            formdata.append("file", fileInput.files[0]);
            formdata.append("data", fileInput.files[0]);
            formdata.append("nft_receiver", publicKey);
            formdata.append('service_charge', `{ "receiver": "9DexaDd8GxVHubvVZeMzninDuJEyFUcYFKEJA8CfHB7u", "amount": 0.01}`);

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: formdata,
                redirect: 'follow'
            };

            fetch("https://api.shyft.to/sol/v1/nft/create_detach", requestOptions)
                .then(async response => {
                    let res = await response.json();
                    let transaction = toTransaction(res.result.encoded_transaction);

                    const signedTransaction = await window.phantom.solana.signTransaction(transaction);
                    const connection = new solanaWeb3.Connection("https://api.devnet.solana.com");
                    const signature = await connection.sendRawTransaction(signedTransaction.serialize());

                    console.log("TRANSACTION CONFIRMED!!")

                })
                .catch(error => console.log('error', error));

        }
        //========= [Mint NFT PRIVATE KEY] ==========

        // const PRIV_KEY_WALLET = "3Hr5XxaPGR2s3t1tSRc6JoGjxJLtD2KdUJtBpGVj7GBemYQu14sL4ttmvJSfBHnyXjkfHn1d7CVeS7KPUY5M4v5d";

        // const mintNftPriv = async () => {
        //     var myHeaders = new Headers();
        //     myHeaders.append("x-api-key", PRIV_KEY);


        //     const fileInput = document.querySelector("#fileInput");

        //     var formdata = new FormData();
        //     formdata.append("network", "devnet");
        //     formdata.append("private_key", PRIV_KEY_WALLET);
        //     formdata.append("name", "Fashion Designer NFT");
        //     formdata.append("symbol", "FD");
        //     formdata.append("description", "NFT Fashion Designer!");
        //     formdata.append("attributes", '[{"trait_type":"dev power","value":"over 900"}]');
        //     formdata.append("external_url", "https://shyft.to");
        //     formdata.append("max_supply", "1");
        //     formdata.append("royalty", "5");//phần trăm hoa hồng nhận dc mỗi gd
        //     formdata.append("file", fileInput.files[0]);
        //     formdata.append("data", fileInput.files[0]);
        //     formdata.append("nft_receiver", publicKey);
        //     formdata.append('service_charge', `{ "receiver": "9DexaDd8GxVHubvVZeMzninDuJEyFUcYFKEJA8CfHB7u", "amount": 0.01}`);

        //     var requestOptions = {
        //         method: 'POST',
        //         headers: myHeaders,
        //         body: formdata,
        //         redirect: 'follow'
        //     };

        //     fetch("https://api.shyft.to/sol/v1/nft/create", requestOptions)
        //         .then(async response => {
        //             console.log("TRANSACTION CONFIRMED!!")

        //         })
        //         .catch(error => console.log('error', error));

        // }

        //========== [Tranfer Solana] ==========

        // const transferSol = async () => {
        //     var myHeaders = new Headers();
        //     myHeaders.append("x-api-key", PRIV_KEY);
        //     myHeaders.append("Content-Type", "application/json");

        //     var raw = JSON.stringify({
        //         "network": "devnet",
        //         "from_address": "78oZPkEVDvpm7DUXHC1ceLPqjazFU4joKzWF3reBWY6",//Người gửi
        //         "to_address": "6JCJ6HTPvYqkk7WhGPWKec2a3D3GhJo4TtbhdAQQhTJd",//Người nhận
        //         "amount": 2,
        //     });

        //     var requestOptions = {
        //         method: 'POST',
        //         headers: myHeaders,
        //         body: raw,
        //         redirect: 'follow'
        //     };

        //     fetch("https://api.shyft.to/sol/v1/wallet/send_sol", requestOptions)
        //         .then(async response => {
        //             let res = await response.json();
        //             let transaction = toTransaction(res.result.encoded_transaction);

        //             await window.phantom.solana.signTransaction(transaction);

        //             console.log("TRANSFER SUCCESSFULLY!!")
        //         })
        //         .then(result => console.log(result))
        //         .catch(error => console.log('error', error));
        // }

        // Thong báo
        // function showNotification() {
        //     let title = "Connect ❤️";
        //     let icon = 'https://homepages.cae.wisc.edu/~ece533/images/zelda.png'; //this is a large image may take more time to show notifiction, replace with small size icon
        //     let body = "CONNECT SUCCESSFULLY!!!";

        //     let notification = new Notification(title, { body, icon });

        //     notification.onclick = () => {
        //         notification.close();
        //         window.parent.focus();
        //     }

        // }

        // const buyNFT = async () => {
        //     var myHeaders = new Headers();
        //     myHeaders.append("x-api-key", PRIV_KEY);
        //     myHeaders.append("Content-Type", "application/json");

        //     var raw = JSON.stringify({
        //         "network": "devnet",
        //         "marketplace_address": "5p4Bua5tSsSo1RJ94H1w5DiMSPfWcvMvnMVjPpZ6sJUb",
        //         "nft_address": "9A75AztajAwN9wTkg1BsC6xDEzC8pgjidtjnURQS5CZy",
        //         "price": 2,
        //         "seller_address": "AaYFExyZuMHbJHzjimKyQBAH1yfA9sKTxSzBc6Nr5X4s",
        //         "buyer_wallet": "GE4kh5FsCDWeJfqLsKx7zC9ijkqKpCuYQxh8FYBiTJe"
        //     });

        //     var requestOptions = {
        //         method: 'POST',
        //         headers: myHeaders,
        //         body: raw,
        //         redirect: 'follow'
        //     };

        //     fetch("https://api.shyft.to/sol/v1/marketplace/buy", requestOptions)
        //         .then(response => response.text())
        //         .then(result => console.log(result))
        //         .catch(error => console.log('error', error));
        // }
    </script>
</body>

</html>